<?php   $this->load->view('site/includes/header');   $this->load->view('site/includes/top_navigation_links');   $currency_result = $this->session->userdata('currency_result');   ?><section>   <div class="container">      <div class="loggedIn clear">         <div class="width20">            <?php $this->load->view('site/experience/ExperienceSideLinks'); ?>         </div>         <div class="width80">            <div class="row">               <div class="col-sm-12">                  <div class="searchTable clear">                     <?php                        echo form_open('');                        if ($this->lang->line('Search Your Trips') != '') {                            $placeholder = stripslashes($this->lang->line('Search Your Trips'));                        } else $placeholder = "Search Your Trips";                        if ($this->lang->line('Search') != '') {                            $btnValue = stripslashes($this->lang->line('Search'));                        } else $btnValue = "Search";                        echo form_input('experience_title', '', array('placeholder' => $placeholder));                        echo form_submit('submit', $btnValue, array('class' => 'submit'));                        echo form_close();                        ?>                  </div>                  <div class="table-responsive">                  <table class="table  table-striped">                     <tr>                        <th width="10%"><?php if ($this->lang->line('BookedOn') != '') {                           echo stripslashes($this->lang->line('BookedOn'));                           } else echo "Booked On"; ?></th>                        <th width="10%"><?php if ($this->lang->line('PropertyName') != '') {                           echo stripslashes($this->lang->line('PropertyName'));                           } else echo "Property Name"; ?></th>                        <th width="5%"><?php if ($this->lang->line('Host') != '') {                           echo stripslashes($this->lang->line('Host'));                           } else echo "Host"; ?></th>                        <th width="25%"><?php if ($this->lang->line('DatesandLocation') != '') {                           echo stripslashes($this->lang->line('DatesandLocation'));                           } else echo "Dates and Location"; ?></th>                        <th width="5%"><?php if ($this->lang->line('Amount') != '') {                           echo stripslashes($this->lang->line('Amount'));                           } else echo "Amount"; ?></th>                        <th width="5%"><?php if ($this->lang->line('PaymentStatus') != '') {                           echo stripslashes($this->lang->line('PaymentStatus'));                           } else echo "Payment Status"; ?></th>                        <th width="5%"><?php if ($this->lang->line('HostApproval') != '') {                           echo stripslashes($this->lang->line('HostApproval'));                           } else echo "Host Approval"; ?></th>                        <th width="5%"><?php if ($this->lang->line('Host Status') != '') {                           echo stripslashes($this->lang->line('Host Status'));                           } else echo "Host Status"; ?></th>                     </tr>                     <?php                        if ($bookedRental->num_rows() > 0) {                            foreach ($bookedRental->result() as $row) {                               // $paymentstatus = $this->cms_model->get_all_details(PAYMENT, array('Enquiryid' => $row->cid));                                $paymentstatus = $this->cms_model->get_all_details(EXPERIENCE_BOOKING_PAYMENT, array('Enquiryid' => $row->cid));                        				                                $chkval = $paymentstatus->num_rows();                                $status = $paymentstatus->row()->status;                                                        $pr_details = $this->cms_model->get_all_details(USERS, array('id' => $row->user_id)); //to display the user is available or not.                                $currencyPerUnitSeller = $row->currencyPerUnitSeller;                                $unitprice = $row->unitPerCurrencyUser;                                $user_currencycode = $row->user_currencycode;                                ?>                     <tr>                        <td><?php echo date('M d, Y', strtotime($row->dateAdded)); ?></td>                        <td>                           <?php                              $imgSrc = 'dummyProductImage.jpg';                              if ($row->product_image != "" && file_exists('./images/experience/' . $row->product_image)) {                                  $imgSrc = $row->product_image;                              }                              echo img(base_url() . 'images/experience/' . $imgSrc);                              ?>							  							  <a href="<?php echo base_url() . 'view_experience/' . $row->experience_id;?>"> <?php echo ucfirst($row->experience_title); ?></a>							                           </td>                        <td><?php echo $row->firstname; ?></td>                        <td>                           <?php if ($row->checkin != '0000-00-00 00:00:00' && $row->checkout != '0000-00-00 00:00:00') {                              echo date('M d, Y', strtotime($row->checkin)) . " - " . date('M d, Y', strtotime($row->checkout));                              } ?>                           <div class="reduceFont"><?php                              if ($row->city_name != '') echo $row->city_name;                              if ($row->city_name != '' && $row->state_name != '') echo ', ';                              if ($row->state_name != '') echo $row->state_name;                              if ($row->country_name != '' && $row->state_name != '') echo ', ';                              if ($row->country_name != '') echo $row->country_name . '.'; ?></div>                           <div><?php                              if ($this->lang->line('booking_no') != '') {                                  echo stripslashes($this->lang->line('booking_no'));                              } else echo "Booking No";                              ?> : <?php echo $row->bookingno; ?>                           </div>                           <?php                              if ($row->date_id != '') {                                  $date_id = $row->date_id;                                  $TimesAre = $this->db->where('exp_dates_id', $date_id)->get(EXPERIENCE_TIMING);                                  $count = $TimesAre->num_rows();                              }                              ?>                           <p class='toggleSchedule'><b><?php if ($this->lang->line('read_timings') != '') {                           echo stripslashes($this->lang->line('read_timings'));                           } else echo "Read Timings"; ?>(<?= $count; ?>)</b></p>                           <div class='scheduleDetails' style="display: none;">                              <?php foreach ($TimesAre->result() as $sched) {                                 echo '<i>' . $sched->title . '</i><br>';                                 echo date('M d, Y', strtotime($sched->schedule_date));                                 echo '<div class="timings">' . date('H:i', strtotime($sched->start_time)) . ' - ' . date('H:i', strtotime($sched->end_time)) . '</div>';                                 } ?>                           </div>                        </td>                        <td><span class="number_s120">                           <?php echo $currencySymbol;                              if ($row->offer > 0) {                                  echo strtoupper($currencySymbol) . " " . number_format(CurrencyValue($row->product_id, $row->totalAmt), 2);                                  echo '<li style="text-decoration: line-through;">' . strtoupper($currencySymbol) . " " . number_format($row->offer * $this->session->userdata('currency_r'), 2) . '</li>';                              } else {                                  if ($row->secDeposit != 0) {                                      $securityDeposite = $row->secDeposit;                                  }                                  $totalAmount = $row->subTotal + $row->serviceFee + $securityDeposite;                                  $currency = $row->currency;                                  if ($row->user_currencycode != $this->session->userdata('currency_type')) {                                      /*if ($currency_result->$currency) {                                          $price = $totalAmount / $currency_result->$currency;                                      } else {                                          $price = currency_conversion($currency, $this->session->userdata('currency_type'), $totalAmount);                                      }*/									   $price = changeCurrency($row->user_currencycode,$this->session->userdata('currency_type'),$totalAmount,$row->currency_cron_id);                                      echo ' ' . number_format($price, 2);                                  } else {                                      echo $totalAmount;                                  }                              }                              echo ' ' . $this->session->userdata('currency_type') ?>                           </span>                        </td>                        <td>                           <?php if ($row->dateAdded < $today) {                              if ($status == "Paid") {                                  if ($this->lang->line(Booked) != '') {                                      echo stripslashes($this->lang->line('Booked'));                                  } else echo "Booked";                              }                              if ($this->lang->line('Expired') != '') {                                  echo stripslashes($this->lang->line('Expired'));                              } else echo "Expired";                              } else {                              if ($status == "Paid") {                                  if ($this->lang->line('Booked') != '') {                                      echo stripslashes($this->lang->line('Booked'));                                  } else echo "Booked";                              } else {                                  $date_id = $row->date_id;                                  $check_in = date('Y-m-d', (strtotime($row->checkin)));                                  $Query = "SELECT IFNULL(count(eq.date_id),0) as date_booked_count from " . EXPERIENCE_ENQUIRY . " as eq where eq.date_id=" . $date_id . " and eq.booking_status='" . Booked . "'";                                  $BookedSlots = $this->experience_model->ExecuteQuery($Query);                                  $AvailableSlots = $row->group_size - $BookedSlots->row()->date_booked_count;                                  $today = date('Y-m-d', strtotime(date('Y-m-d')));                                  $BeforOneDay = date('Y-m-d', (strtotime('+1 day', strtotime($today))));                                  if ($AvailableSlots != '0' && $BeforOneDay <= $check_in) { ?>                           <a class=""                              href="<?= base_url(); ?>site/experience/confirmbooking/<?php echo $row->cid; ?>"><?php if ($this->lang->line('Pay') != '') {                              echo stripslashes($this->lang->line('Pay'));                              } else echo "Pay"; ?></a><?php } else if ($AvailableSlots != '0' && $check_in <= $today) {                              if ($this->lang->line('Expired') != '') {                                  echo stripslashes($this->lang->line('Expired'));                              } else echo "Expired";                              } else if ($AvailableSlots == '0' && $BeforOneDay <= $check_in) {                              if ($this->lang->line('Expired') != '') {                                  echo stripslashes($this->lang->line('Expired'));                              } else echo "Expired";                              } else {                              if ($this->lang->line('Expired') != '') {                                  echo stripslashes($this->lang->line('Expired'));                              } else echo "Expired";                              }                              }                              } ?> </p>                           <?php if ($status == "Paid") { ?>                           <a href="<?= base_url(); ?>site/experience/invoice/<?php echo $row->bookingno; ?>"                              target="_blank"><?php if ($this->lang->line('Receipts/Invoice') != '') {                              echo stripslashes($this->lang->line('Receipts/Invoice'));                              } else echo "Receipts/Invoice"; ?></a>                           <?php                              $this->data['reviewData_all'] = $this->experience_model->get_trip_review_all($userDetails->row()->id);                              $reviewData = $this->experience_model->get_trip_review($row->bookingno, $userDetails->row()->id);                              $this->data['hostreviewData'] = $this->experience_model->get_trip_review_host($row->bookingno, $userDetails->row()->id);                               $time_val = date('Y-m-d');                              if ($reviewData->num_rows() == 0) { ?>                           <a data-toggle="modal" href="#add_review"                              onclick="return add_data(this,'0')"                              user_id="<?php echo $row->renter_id; ?>"                              product_id="<?php echo $row->product_id; ?>"                              reviewer_id="<?php if ($userDetails != 'no') {                                 echo $userDetails->row()->id;                                 } ?>" booking_no="<?php if ($userDetails != 'no') {                                 echo $row->bookingno;                                 } ?>" pro_title="<?php echo $row->experience_title; ?>"                              img_src="<?php echo ($row->product_image != "" && file_exists("images/experience/" . $row->product_image)) ? base_url() . 'images/experience/' . $row->product_image : base_url() . 'images/experience/dummyProductImage.jpg'; ?>"><?php if ($this->lang->line('Review') != '') {                              echo stripslashes($this->lang->line('Review'));                              } else echo "Review"; ?></a>                           <?php } else { ?>                           <a data-toggle="modal" href="#display_review"                              onclick="return booking_review(this,'0')"                              user_id="<?php echo $row->renter_id; ?>"                              product_id="<?php echo $row->product_id; ?>"                              booking_no="<?php echo $row->bookingno; ?>"                              reviewer_id="<?php if ($userDetails != 'no') {                                 echo $userDetails->row()->id;                                 } ?>"><?php if ($this->lang->line('YourReview') != '') {                              echo stripslashes($this->lang->line('YourReview'));                              } else echo "Your Review"; ?></a>                           <?php }                            /* Review to host */                               if ($this->data['hostreviewData']->num_rows() == 0) { ?>                                   <br>                                   <a data-toggle="modal" href="#add_review"                                      onclick="return add_data(this,'1')"                                      user_id="<?php echo $row->renter_id; ?>"                                      product_id="<?php echo $row->product_id; ?>"                                      reviewer_id="<?php if ($userDetails != 'no') {                                          echo $userDetails->row()->id;                                      } ?>" booking_no="<?php if ($userDetails != 'no') {                                       echo $row->bookingno;                                   } ?>" pro_title="<?php echo $row->product_title; ?>"                                      img_src="<?php echo ($row->product_image != "" && file_exists("images/rental/" . $row->product_image)) ? base_url() . 'images/rental/' . $row->product_image : base_url() . 'images/rental/dummyProductImage.jpg'; ?>"><?php if ($this->lang->line('ReviewOwner') != '') {                              echo stripslashes($this->lang->line('ReviewOwner'));                              } else echo "Review Owner"; ?></a>                               <?php } else { ?>                                   <br>                                   <a data-toggle="modal" href="#display_review"                                      onclick="return booking_review(this,'1')"                                      user_id="<?php echo $row->renter_id; ?>"                                      product_id="<?php echo $row->product_id; ?>"                                      booking_no="<?php echo $row->bookingno; ?>"                                      reviewer_id="<?php if ($userDetails != 'no') {                                          echo $userDetails->row()->id;                                      } ?>"><?php if ($this->lang->line('ReviewOwner') != '') {                              echo stripslashes($this->lang->line('OwnerReview'));                              } else echo "Owner Review"; ?></a>                               <?php }                           /* Review to host */						   						  //canelStart						                                 $Check_date = $this->experience_model->get_all_details(EXPERIENCE_ENQUIRY, array('user_id' => $user_id, 'prd_id' => $row->product_id));                              $time_val = date('Y-m-d');                              $check_in = date("Y-m-d", strtotime($row->checkin));                              $check_out = date("Y-m-d", strtotime($row->checkout));							  //echo EXPERIENCE_DISPUTE; exit;fc_experience_dispute                              $dis_details = $this->experience_model->get_all_details(EXPERIENCE_DISPUTE, array('user_id' => $user_id, 'prd_id' => $row->product_id, 'booking_no' => $row->bookingno));                              $admin = $this->experience_model->getAdminSettings(ADMIN_SETTINGS);                              $dipute_day = $admin->row()->dispute_days;                              $after_day = strtotime("+" . $dipute_day . "days", strtotime($check_in));                              $out_date = date('Y-m-d', $after_day);							                                /*======*/							 // echo 'num rows'.$dis_details->num_rows();                              if ($dis_details->num_rows() == 0) {                                  $hideCancelDay = $this->config->item('cancel_hide_days_experience');                                  $totlessDays = $hideCancelDay + 1; //from checkin date before (n) days                                  $minus_checkin = strtotime("-" . $totlessDays . "days", strtotime($check_in));                                  $checkinBeforeDay = date('Y-m-d', $minus_checkin);									//echo $time_val.'|'.$checkinBeforeDay.'|'.$out_date.'|'.$check_in;									if ($time_val <= $checkinBeforeDay) {                                        if (($time_val) < $out_date) {                                          if (($time_val) > $check_in) {                                  /*if ($time_val >= $checkinBeforeDay) {  								                                        if (($time_val) < $out_date) {                                          if (($time_val) > $check_in) {*/											  //echo 'inside';                                              ?>                           <br>												   <!--No dispute for experience -->                                                     <?php }else{ ?>							   							      <!--cancel -->						   						   						    <br><a data-toggle="modal"                              href="#cancel_booking_<?php echo $row->bookingno; ?>"><?php if ($this->lang->line('Cancel') != '') {                              echo stripslashes($this->lang->line('Cancel'));                              } else echo "Cancel"; ?> </a>                           <!-- Cancel booking Modal -->                           <div id="cancel_booking_<?php echo $row->bookingno; ?>"                              class="modal2Col modal fade"                              role="dialog">                              <div class="modal-dialog">                                 <!-- Modal content-->                                 <div class="modal-content">                                    <div class="modal-header">                                       <button type="button"                                          class="close"                                          data-dismiss="modal">                                       &times;                                       </button>                                       <h2><?php if ($this->lang->line('cancel_booking') != '') {                                          echo stripslashes($this->lang->line('cancel_booking'));                                          } else echo "Cancel Booking"; ?></h2>                                    </div>                                    <div class="modal-body">                                       <div class="tableRow">                                          <div class="left">                                             <img src="<?php echo ($row->product_image != "" && file_exists('./images/experience/' . $row->product_image)) ? base_url() . 'images/experience/' . $row->product_image : base_url() . "images/experience/dummyProductImage.jpg"; ?>"                                                class="propIcon">                                          </div>                                          <div class="right">                                             <div class="clear">                                                <h5><?php echo ucfirst($row->experience_title); ?></h5>                                                <div class="address">                                                   <?php echo ucfirst($row->prd_address); ?>                                                </div>                                             </div>                                             <div class="content">                                                <?php                                                   echo form_open('site/experience/cancel_booking', array('name'=>'cancelForm'));                                                   echo form_hidden('prd_id', $row->product_id);                                                   echo form_hidden('bookingNo', $row->bookingno);                                                   echo form_hidden('cancellation_percentage', $row->cancel_percentage);                                                   echo form_hidden('disputer_id', $row->renter_id);                                                   echo form_hidden('email', $userDetails->row()->email);                                                   echo form_hidden('trip_url', $this->uri->segment(2));												    $textAreaBox = array(														'name'        => 'message',														'id'          => 'cancel_msg_'.$row->bookingno,														/*'value'       => set_value('vc_desc'),														'style'       => 'width:50%',														'class'       => 'form-control'*/                            'required'       => 'required',														'rows'        => '10',														'cols'        => '40'																											);													  echo '<div class="alert alert-danger myError" style="display:none"><strong>Warning!</strong> Please enter details!</div>';													echo form_textarea($textAreaBox);                                                  // echo form_textarea('message', '');												                                                   ?>                                             </div>                                             <div class="colRight">											 <?php if ($this->lang->line('cancel_booking') != '') {												$can_bk= stripslashes($this->lang->line('cancel_booking'));												} else $can_bk= "Cancel Booking"; ?>											 <button name="makeReview" type="button" id="can_exp_btn" style="display: none;" class="submitBtn1"><i id="spin" class="fa fa-spinner fa-spin"></i><?php  echo $can_bk; ?></button>                                                <?php                                                   //echo form_submit('', $can_bk, array('class' => 'submitBtn1'));												   echo form_button('', $can_bk, array('id' => 'can_btn_bef','class' => 'submitBtn1','onclick'=>'cancelBukFun(\''.$row->bookingno.'\')'));                                                   echo form_close();                                                   ?>                                             </div>                                          </div>                                       </div>                                    </div>                                 </div>                              </div>                           </div>						   						   <!--//cancel -->							   							   						<?php   }								} else {  									//dispute hided									}                              }  							  } else { 							                                  if ($dis_details->row()->cancel_status == 1) { ?>                           <br><a data-toggle="modal"                              href="#canceled_<?php echo $row->bookingno; ?>"><?php if ($this->lang->line('canceled') != '') {                              echo stripslashes($this->lang->line('canceled'));                              } else echo "Canceled"; ?></a>                           <div id="canceled_<?php echo $row->bookingno; ?>"                              class="modal2Col modal fade"                              role="dialog">                              <div class="modal-dialog">                                 <!-- Modal content-->                                 <div class="modal-content">                                    <div class="modal-header">                                       <button type="button" class="close"                                          data-dismiss="modal">&times;                                       </button>                                       <h2><?php if ($this->lang->line('canceled') != '') {                                          echo stripslashes($this->lang->line('canceled'));                                          } else echo "Canceled"; ?></h2>                                    </div>                                    <div class="modal-body">                                       <div class="tableRow">                                          <div class="left">                                             <img src="<?php echo ($row->product_image != "" && file_exists('./images/experience/' . $row->product_image)) ? base_url() . 'images/experience/' . $row->product_image : base_url() . "images/experience/dummyProductImage.jpg"; ?>"                                                class="propIcon">                                          </div>                                          <div class="right">                                             <div class="clear">                                                <h5><?php                                                 $prod_tiltle=language_dynamic_enable("experience_title",$this->session->userdata('language_code'),$row);                                                    //echo ucfirst($row->experience_title);                                                 echo $prod_tiltle;                                                  ?></h5>                                                <div class="address">                                                   <?php echo ucfirst($row->prd_address); ?>                                                </div>                                             </div>                                             <div class="content">                                                <?php if (!empty($dis_details)) {                                                   echo ucfirst($dis_details->row()->message);                                                   } ?>                                             </div>                                             <div class="colRight">                                                <i class=""><?php if (!empty($dis_details)) {                                                   echo date('d-m-Y', strtotime($dis_details->row()->created_date));                                                   } ?></i>                                             </div>                                          </div>                                       </div>                                    </div>                                 </div>                              </div>                           </div>                           <?php } 						   							  }                               ?>							  							<!--canelEnd -->  							                             <br>                           <a data-toggle="modal" href="#message"                              onclick="return post_discussion(this)"                              renter_id="<?php echo $row->renter_id; ?>"                              product_id="<?php echo $row->product_id; ?>"                              booking_no="<?php echo $row->bookingno; ?>"                              reviewer_id="<?php if ($userDetails != 'no') {                                 echo $userDetails->row()->id;                                 } ?>"><?php if ($this->lang->line('Message') != '') {                              echo stripslashes($this->lang->line('Message'));                              } else echo "Message"; ?></a>                           <?php } ?>						                           </td>												                        <td> <?php if ($row->dateAdded < $today) {                           echo "-";                           } else {                           echo ($row->approval == "Decline") ? "Declined" : "";                           // $paymentstatus = $this->product_model->get_all_details(PAYMENT, array('Enquiryid' => $row->cid));                           $paymentstatus = $this->product_model->get_all_details(EXPERIENCE_BOOKING_PAYMENT, array('Enquiryid' => $row->cid));                           $chkval = $paymentstatus->num_rows();                           $chkval1 = $paymentstatus->row()->status;                           if ($row->approval == 'Accept' && ($chkval == 0 || $chkval1 == 'Pending')) {                               if ($this->lang->line('Approved') != '') {                                   echo stripslashes($this->lang->line('Approved'));                               } else echo "Approved";                           } elseif ($row->approval != "Decline" && $chkval == 0) {                               if ($this->lang->line('Pending Confirmation') != '') {                                   echo stripslashes($this->lang->line('Pending Confirmation'));                               } else echo "Pending Confirmation";                           } else if ($row->approval != "Decline") if ($this->lang->line('Approved') != '') {                               echo stripslashes($this->lang->line('Approved'));                           } else echo "Approved";                           } ?> </td>                        <td><?php if ($pr_details->row()->host_status == 1) {                           if ($this->lang->line('host is not available') != '') {                               echo stripslashes($this->lang->line('host is not available'));                           } else echo "host is not available";                           } else if ($pr_details->row()->status == 'Inactive') {                           if ($this->lang->line('host is not available') != '') {                               echo stripslashes($this->lang->line('host is not available'));                           } else echo "host is not available";                           } else if ($pr_details->row()->host_status == 1 || $pr_details->row()->status == 'Inactive') {                           if ($this->lang->line('host is not available') != '') {                               echo stripslashes($this->lang->line('host is not available'));                           } else echo "host is not available";                           } elseif ($pr_details->row()->host_status == 0 && $pr_details->row()->status == 'Active') {                           if ($this->lang->line('host is available') != '') {                               echo stripslashes($this->lang->line('host is available'));                           } else echo "host is available";                           } ?></td>                     </tr>                     <?php }                        } else {                            ?>                     <tr>                        <td colspan="8">                           <p                              class="text-center text-danger"> <?php if ($this->lang->line('Youhaveno') != '') {                              echo stripslashes($this->lang->line('Youhaveno'));                              } else echo "You have no current trips."; ?> </p>                        </td>                     </tr>                     <?php                        } ?>                  </table>                </div>               </div>               <div class="col-lg-12 myPage">                  <div class="myPagination" id="page_numbers">                     <?php                        echo $paginationLink;                        ?>                  </div>               </div>            </div>         </div>      </div>   </div></section><!--Add new review for the property--><div id="add_review" class="modal fade" role="dialog">   <div class="modal-dialog">      <!-- Modal content-->      <div class="modal-content">         <div class="modal-header">            <button type="button" class="close" data-dismiss="modal">&times;</button>            <h2><?php if ($this->lang->line('Add Review') != '') {               echo stripslashes($this->lang->line('Add Review'));               } else echo "Add Review"; ?></h2>         </div>         <div class="modal-body">            <div class="tableRow reviewList_1 noBorder">               <div class="left">                  <img src="" id="pro_img" class="userIcon">               </div>               <div class="right">                  <div class="clear">                     <div class="colLeft">                        <h5 id="pro_title" class="text-capitalize"></h5>                        Booking No: <span id="booking_no_show"></span>                     </div>                  </div>                  <div class="content">                     <label><?php if ($this->lang->line('My review') != '') {                        echo stripslashes($this->lang->line('My review'));                        } else echo "My review"; ?><span>*</span>                     <small style="color:#666;">                     (<?php if ($this->lang->line('Exclude personally identifiable information such as name, email address, etc') != '') {                        echo stripslashes($this->lang->line('Exclude personally identifiable information such as name, email address, etc'));                        } else echo "Exclude personally identifiable information such as name, email address, etc"; ?>                     )                     </small>                     </label>                     <?php if ($loginCheck != '') {                        echo form_open('site/experience/add_review', array('id' => 'reviewFormSubmit'));                        echo form_input(array('name' => 'proid', 'id' => 'proid', 'type' => 'hidden'));                        echo form_input(array('name' => 'user_id', 'id' => 'user_id', 'type' => 'hidden'));                        echo form_input(array('name' => 'type', 'id' => 'type', 'type' => 'hidden','value'=>'0'));                        echo form_input(array('name' => 'bookingno', 'id' => 'booking_no', 'type' => 'hidden'));                        echo form_input(array('name' => 'reviewer_id', 'value' => $userDetails->row()->id, 'type' => 'hidden'));                        echo form_input(array('name' => 'reviewer_email', 'value' => $userDetails->row()->email, 'type' => 'hidden'));                        echo form_textarea(array('name' => 'review', 'id' => 'review-text-value', 'rows' => '5', 'maxlength' => '300'));                        ?>												                      <div class="rating">                        <?php if ($this->lang->line('Rating') != '') {                           echo stripslashes($this->lang->line('Rating'));                           } else echo "Rating"; ?> :                        <?php                           echo form_radio('total_review', '5', FALSE,  array("id" => "star5"), '') . '<label for="star5" title="5 star" >5 star</label> ';                           echo form_radio('total_review', '4', FALSE, array("id" => "star4"), '') . '<label for="star4" title="4 star" >4 star</label> ';                                                      echo form_radio('total_review', '3', FALSE, array("id" => "star3"), '') . '<label for="star3" title="3 star" >3 star</label> ';                                                      echo form_radio('total_review', '2', FALSE, array("id" => "star2"), '') . '<label for="star2" title="2 star" >2 star</label> ';                                                      echo form_radio('total_review', '1', FALSE, array("id" => "star1"), '') . '<label for="star1" title="1 star" >1 star</label> ';                                                      } ?>                     </div>                  </div>                  <div class="colRight">				  <?php if ($this->lang->line('Submit my review') != '') {                        $submit_rev= stripslashes($this->lang->line('Submit my review'));                        } else $submit_rev= "Submit my review"; ?>				  <button name="makeReview" type="button" id="rev_exp_btn" style="display: none;" class="submitBtn1"><i id="spin" class="fa fa-spinner fa-spin"></i><?php  echo $submit_rev; ?></button>                     <?php                        echo form_button('makeReview', $submit_rev, array('onClick' => 'add_review();', 'class' => 'submitBtn1', 'id' => 'rev_btn_bef'));                        echo form_close();                        ?>                  </div>               </div>            </div>         </div>      </div>   </div></div><!-- Message Modal --><div id="message" class="modal fade" role="dialog">   <div class="modal-dialog">      <!-- Modal content-->      <div class="modal-content">         <div class="modal-header">            <button type="button" class="close" data-dismiss="modal">&times;</button>            <h2 class="mHead"><?php if ($this->lang->line('Message to Host') != '') {               echo stripslashes($this->lang->line('Message to Host'));               } else echo "Message to Host"; ?></h2>         </div>         <div class="modal-body">            <div>			<?php if ($this->lang->line('send_message_to_host') != '') {               $send_msg= stripslashes($this->lang->line('send_message_to_host'));               } else $send_msg= "Send Message to Host"; ?>			               <?php                  echo form_open('site/experience/add_discussion', array('id' => 'add_discussion'));                  echo form_input(array('name' => 'rental_id', 'id' => 'rental_id', 'type' => 'hidden'));                  echo form_input(array('name' => 'sender_id', 'id' => 'sender_id', 'type' => 'hidden'));                  echo form_input(array('name' => 'receiver_id', 'id' => 'receiver_id', 'type' => 'hidden'));                  echo form_input(array('name' => 'bookingno', 'id' => 'booking_id', 'type' => 'hidden'));                  echo form_input(array('name' => 'posted_by', 'value' => 'posted_by', 'type' => 'hidden'));                  echo form_input(array('name' => 'redirect', 'value' => $this->uri->segment(1) . '/' . $this->uri->segment(2), 'type' => 'hidden'));                  echo form_textarea(array('name' => 'message', 'placeholder' => $send_msg,'required' => 'required' , 'id' => 'message-text', 'rows' => '7'));                  echo form_submit('', ($this->lang->line('Send') != '') ? stripslashes($this->lang->line('Send')) : 'Send', array('class' => 'submitBtn1'));                  echo form_close();                  ?>            </div>         </div>      </div>   </div></div><!-- My Review Modal --><div id="display_review" class="modal fade" role="dialog">   <div class="modal-dialog">      <!-- Modal content-->      <div class="modal-content">         <div class="modal-header">            <button type="button" class="close" data-dismiss="modal">&times;</button>            <h2><?php if ($this->lang->line('Your Review') != '') {               echo stripslashes($this->lang->line('Your Review'));               } else echo "Your Review"; ?></h2>         </div>         <div class="modal-body">            <div class="tableRow reviewList_1 noBorder">               <div class="left">                  <?php                     if ($userDetails->row()->image != '' && file_exists('./images/users/' . $userDetails->row()->image)) {                         $imgSource = "images/users/" . $userDetails->row()->image;                     } else {                         $imgSource = "images/users/profile.png";                     }                     echo img($imgSource, TRUE, array('class' => 'userIcon'));                     ?>               </div>               <div class="right">                  <?php                     $reviewData = $this->data['reviewData_all'];                     if ($reviewData != '') {                         foreach ($reviewData->result_array() as $review):                          $id_str="listing_";                                if($review['review_type']==1){                                    $id_str="owner_";                                }                          ?>                  <div style="display: none;"                                     id="<?php echo $id_str.$review['bookingno']; ?>" class="PropReview PropReview_<?php echo $review['bookingno']; ?>">                                    <div class="clear">                                        <div class="colLeft">                                            <div class="starRatingOuter1">                                                <div class="starRatingInner1"                                                     style="width: <?php echo $review['total_review'] * 20 ?>%;"></div>                                            </div>                                        </div>                                        <div class="colRight">                                            Booking No: <?= $review['bookingno']; ?>                                        </div>                                    </div>                                    <div class="content"><?php echo $review['review']; ?>                                    </div>                                    <div class="colRight">                                        <div class="email"><?php echo $review['email']; ?>                                            - <?php echo date('d-m-Y', strtotime($review['dateAdded'])); ?>                                        </div>                                    </div>                                </div>                  <?php endforeach;                     } ?>               </div>            </div>         </div>      </div>   </div></div><script>   $(document).on("click", ".toggleSchedule", function () {       $(this).next(".scheduleDetails").slideToggle();	});      function add_data(evt,type) {       var product_id = $(evt).attr('product_id');       var reviewer_id = $(evt).attr('reviewer_id');       var booking_no = $(evt).attr('booking_no');       var user_id = $(evt).attr('user_id');       var pro_title = $(evt).attr('pro_title');       var img_src = $(evt).attr('img_src');       $('#add_review #user_id').val(user_id);       $('#add_review #proid').val(product_id);       $('#add_review #booking_no').val(booking_no);       $('#add_review #booking_no_show').html(booking_no);       $('#add_review #pro_title').html(pro_title);       $('#add_review #pro_img').attr("src", img_src);       $('#add_review #type').val(type);   }      /*Create add review form values*/   function add_review() { $('#rev_exp_btn').show();  $('#rev_btn_bef').hide();	   	var ratings=document.getElementsByName("total_review");		var check1=0;		for (i=0;i<ratings.length;i++){			if(ratings[i].checked){				check1++;				break;			}		}		 if ($('textarea#review-text-value').val() == '') {       $('#rev_exp_btn').hide();  $('#rev_btn_bef').show();           $('#review-text-value').focus();           return false;		}		else if(check1){		}else{          $('#rev_exp_btn').hide();  $('#rev_btn_bef').show();			alert("<?php if ($this->lang->line('give_a_rating') != '') {					echo stripslashes($this->lang->line('give_a_rating'));					} else echo "Give a Rating"; ?>");			return false;		}      $('#reviewFormSubmit').submit();   }      /*Showing review*/   function booking_review(evt,type) {       var booking_no = $(evt).attr('booking_no');       var user_id = $(evt).attr('user_id');       $('.PropReview').hide();        if(type==1){            $('#owner_' + booking_no).show();        }else {            $('#listing_' + booking_no).show();        }   }      /*Show send message form*/   function post_discussion(evt) {       $('#rental_id').val($(evt).attr('product_id'));       $('#sender_id').val($(evt).attr('reviewer_id'));       $('#receiver_id').val($(evt).attr('renter_id'));       $('#booking_id').val($(evt).attr('booking_no'));   }   function cancelBukFun(bookingNumber)   {     $('#can_exp_btn').show();      $('#can_btn_bef').hide();	   cancelMsg = $('#cancel_msg_'+bookingNumber).val();	   if(cancelMsg=='')	   {       $('#can_exp_btn').hide();      $('#can_btn_bef').show();		   $('.myError').show();	   }	   else	   {		   $('.myError').hide();		   $("form[name='cancelForm']").submit();	   }   }</script><?php   $this->load->view('site/includes/footer');   ?>